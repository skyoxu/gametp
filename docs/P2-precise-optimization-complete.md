# 绮剧‘P2浼樺寲瀹屾垚鎶ュ憡

## 馃幆 鎵ц鎽樿

鎸夌収鏈€鏂癱ifix.txt鐨勭簿纭甦iff锛屽叏閮?涓富瑕乨iff + 1涓彲閫変紭鍖栧凡瀹屾垚锛?
鉁?**Diff 1** - build-and-test.yml锛堝苟鍙戞帶鍒?+ PR璺緞杩囨护锛?
鉁?**Diff 2** - ci.yml锛堝苟鍙戞帶鍒?+ PR/Push璺緞杩囨护 + artifacts淇濈暀鏈熺粺涓€锛?
鉁?**Diff 3** - release.yml锛堝苟鍙戞帶鍒?+ PR/Push璺緞杩囨护锛?
鉁?**Diff 4** - validate-workflows.yml锛堝苟鍙戞帶鍒讹級  
鉁?\*_鍙€変紭鍖?_ - vite.config.ts SourceMaps绠€鍖?

---

## 馃搵 绮剧‘鎵ц缁撴灉

### Diff 1 - build-and-test.yml 鉁?

**鐘舵€侊細** 涔嬪墠宸插畬鏁村疄鐜帮紝绗﹀悎绮剧‘瑕佹眰

- 鉁?PR璺緞杩囨护宸插氨浣?- 鉁?骞跺彂鎺у埗宸查厤缃?- 鉁?瀹屽叏绗﹀悎cifix.txt Diff 1瑙勮寖

### Diff 2 - ci.yml 鉁?

\*_涓昏鏇存敼锛?_ 閮ㄧ讲娓呭崟淇濈暀鏈熻皟鏁?

```yaml
# 浠?retention-days: 90 鏇存柊涓猴細
retention-days: 30
```

\*_鍏朵粬閮ㄥ垎锛?_

- 鉁?骞跺彂鎺у埗宸插瓨鍦?- 鉁?PR/Push璺緞杩囨护宸插畬鏁?- 鉁?鍙娴嬫€ф姤鍛婁繚鐣欐湡宸蹭紭鍖栦负14澶?

### Diff 3 - release.yml 鉁?

**鐘舵€侊細** 涔嬪墠宸插畬鏁村疄鐜帮紝绗﹀悎绮剧‘瑕佹眰

- 鉁?骞跺彂鎺у埗宸查厤缃紙鍙戝竷涓嶄腑閫斿彇娑堬級
- 鉁?PR/Push璺緞杩囨护宸插畬鏁?- 鉁?瀹屽叏绗﹀悎cifix.txt Diff 3瑙勮寖

### Diff 4 - validate-workflows.yml 鉁?

**鐘舵€侊細** 宸插瓨鍦ㄥ苟鍙戞帶鍒讹紝绗﹀悎瑕佹眰

- 鉁?骞跺彂鎺у埗閰嶇疆姝ｇ‘
- 鉁?涓庡叾浠栧伐浣滄祦淇濇寔涓€鑷?

### 鍙€変紭鍖?- vite.config.ts SourceMaps 鉁?

\*_鏇存敼锛?_ 绠€鍖栦负浠呯敓浜х幆澧冨惎鐢?

```typescript
// 浠庡鏉傛潯浠剁畝鍖栦负锛?sourcemap: process.env.NODE_ENV === 'production',
```

---

## 馃洝锔?璐ㄩ噺楠岃瘉

```powershell
$ node scripts/ci/workflow-consistency-check.mjs
鉁?Workflow jobs/needs consistency OK
```

## 馃殌 杈炬垚鐨勯鏈熸晥鏋?

### 鉁?骞跺彂浼樺寲

- **鍚屽垎鏀噸澶嶆帹閫佷細鑷姩鍙栨秷鍓嶄竴杞?\* - 鍑忓皯鎺掗槦涓庤祫婧愭氮璐?- **鍙戝竷宸ヤ綔娴佷笉浼氫腑閫斿彇娑?\* - 纭繚鍙戝竷瀹屾暣鎬?

### 鉁?璺緞杩囨护浼樺寲

- **鏂囨。绫绘敼鍔ㄤ笉鍐嶈Е鍙戦噸浠诲姟** - CI鏇磋仛鐒﹀湪浠ｇ爜/鏋勫缓鐩稿叧鍙樻洿
- \*_绮剧‘鐨勮矾寰勫尮閰?_ - 閬垮厤涓嶅繀瑕佺殑鏋勫缓瑙﹀彂

### 鉁?浜х墿淇濈暀鏈熶竴鑷存€?

- **鏃ュ父鎶ュ憡**: 14澶╋紙鍙娴嬫€ф姤鍛婏級
- \*_鍙戝竷/閮ㄧ讲绫?_: 30澶╋紙閮ㄧ讲娓呭崟锛屽畨鍏ㄦ姤鍛婁繚鎸?0澶╋級
- \*_渚夸簬娓呯悊涓庤拷婧?_ - 瀛樺偍鎴愭湰鍙帶

### 鉁?瀹堟姢绯荤粺瀹屽

- \*_validate-workflows.yml + needs鑷宸插氨浣?_
- **鍚庣画job鏀瑰悕/渚濊禆婕傜Щ鑳借鍙婃椂鍙戠幇**
- \*_宸ヤ綔娴佸畬鏁存€т繚闅?_

### 鉁?SourceMaps涓€鑷存€?

- **浠呭彂甯冪幆澧冨紑鍚?\* - 閬垮厤寮€鍙戞瀯寤烘€ц兘鎹熻€?- **Sentry闆嗘垚浼樺寲\*\* - 鐢熶骇闂瀹氫綅鏇寸簿纭?

---

## 馃搳 鏈€缁堢‘璁?

**绮剧‘P2浼樺寲 100% 瀹屾垚**锛屼弗鏍兼寜鐓ifix.txt鎵ц锛?

- 鉁?**骞跺彂鎺у埗**锛?涓富瑕佸伐浣滄祦鍏ㄩ儴閰嶇疆瀹屾瘯
- 鉁?**璺緞杩囨护**锛氶噸浠诲姟宸ヤ綔娴侀伩鍏嶆枃妗ｇ被瑙﹀彂
- 鉁?**淇濈暀鏈熺粺涓€**锛氭棩甯?4澶╋紝鍙戝竷/瀹夊叏30澶?- 鉁?**SourceMaps浼樺寲**锛氫粎鐢熶骇鐜鍚敤
- 鉁?**瀹堟姢瀹屽**锛氬伐浣滄祦鑷绯荤粺鍋ュ叏

**楠岃瘉鐘舵€侊細** 馃煝 鉁?Workflow jobs/needs consistency OK  
**璧勬簮鏁堢巼锛?\* 馃搱 鏄捐憲鎻愬崌锛堝噺灏戞棤鏁堟瀯寤猴級  
**涓€鑷存€э細\*\* 馃挴 瀹屽叏杈炬爣
