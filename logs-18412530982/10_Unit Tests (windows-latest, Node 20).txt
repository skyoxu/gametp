2025-10-10T16:35:30.9616744Z Current runner version: '2.328.0'
2025-10-10T16:35:30.9643194Z ##[group]Runner Image Provisioner
2025-10-10T16:35:30.9643926Z Hosted Compute Agent
2025-10-10T16:35:30.9644466Z Version: 20250912.392
2025-10-10T16:35:30.9645050Z Commit: d921fda672a98b64f4f82364647e2f10b2267d0b
2025-10-10T16:35:30.9645701Z Build Date: 2025-09-12T15:23:14Z
2025-10-10T16:35:30.9646197Z ##[endgroup]
2025-10-10T16:35:30.9646729Z ##[group]Operating System
2025-10-10T16:35:30.9647272Z Microsoft Windows Server 2025
2025-10-10T16:35:30.9647755Z 10.0.26100
2025-10-10T16:35:30.9648254Z Datacenter
2025-10-10T16:35:30.9648676Z ##[endgroup]
2025-10-10T16:35:30.9649102Z ##[group]Runner Image
2025-10-10T16:35:30.9649575Z Image: windows-2025
2025-10-10T16:35:30.9650073Z Version: 20250929.44.1
2025-10-10T16:35:30.9650984Z Included Software: https://github.com/actions/runner-images/blob/win25/20250929.44/images/windows/Windows2025-Readme.md
2025-10-10T16:35:30.9652753Z Image Release: https://github.com/actions/runner-images/releases/tag/win25%2F20250929.44
2025-10-10T16:35:30.9653711Z ##[endgroup]
2025-10-10T16:35:30.9654746Z ##[group]GITHUB_TOKEN Permissions
2025-10-10T16:35:30.9657062Z Actions: read
2025-10-10T16:35:30.9657614Z Contents: read
2025-10-10T16:35:30.9658081Z Metadata: read
2025-10-10T16:35:30.9658589Z ##[endgroup]
2025-10-10T16:35:30.9660534Z Secret source: Actions
2025-10-10T16:35:30.9661257Z Prepare workflow directory
2025-10-10T16:35:31.0166790Z Prepare all required actions
2025-10-10T16:35:31.0204095Z Getting action download info
2025-10-10T16:35:31.2447122Z Download action repository 'actions/checkout@v4' (SHA:08eba0b27e820071cde6df949e0beb9ba4906955)
2025-10-10T16:35:31.3960821Z Download action repository 'actions/setup-node@v5.0.0' (SHA:a0853c24544627f65ddf259abe73b1d18a591444)
2025-10-10T16:35:31.5883206Z Download action repository 'actions/upload-artifact@v4' (SHA:ea165f8d65b6e75b540449e92b4886f43607fa02)
2025-10-10T16:35:31.9296217Z Complete job name: Unit Tests (windows-latest, Node 20)
2025-10-10T16:35:32.0713171Z ##[group]Run actions/checkout@v4
2025-10-10T16:35:32.0714805Z with:
2025-10-10T16:35:32.0715517Z   repository: skyoxu/gametp
2025-10-10T16:35:32.0716373Z   token: ***
2025-10-10T16:35:32.0716787Z   ssh-strict: true
2025-10-10T16:35:32.0717202Z   ssh-user: git
2025-10-10T16:35:32.0717595Z   persist-credentials: true
2025-10-10T16:35:32.0718062Z   clean: true
2025-10-10T16:35:32.0718455Z   sparse-checkout-cone-mode: true
2025-10-10T16:35:32.0718946Z   fetch-depth: 1
2025-10-10T16:35:32.0719376Z   fetch-tags: false
2025-10-10T16:35:32.0719776Z   show-progress: true
2025-10-10T16:35:32.0720184Z   lfs: false
2025-10-10T16:35:32.0720558Z   submodules: false
2025-10-10T16:35:32.0720976Z   set-safe-directory: true
2025-10-10T16:35:32.0721782Z env:
2025-10-10T16:35:32.0722172Z   NODE_VERSION_MATRIX: 18.x, 20.x, 22.x
2025-10-10T16:35:32.0722688Z   COVERAGE_THRESHOLD: 90
2025-10-10T16:35:32.0723129Z   SENTRY_DSN: 
2025-10-10T16:35:32.0723616Z   SENTRY_TRACES_SAMPLE_RATE: 0
2025-10-10T16:35:32.0724092Z   CL: /std:c++20 /EHsc
2025-10-10T16:35:32.0724561Z   CXXFLAGS: -std=c++20
2025-10-10T16:35:32.0724983Z   NODE_ENV: development
2025-10-10T16:35:32.0725441Z   NPM_CONFIG_PRODUCTION: false
2025-10-10T16:35:32.0725899Z ##[endgroup]
2025-10-10T16:35:32.2811876Z Syncing repository: skyoxu/gametp
2025-10-10T16:35:32.2813958Z ##[group]Getting Git version info
2025-10-10T16:35:32.2814586Z Working directory is 'D:\a\gametp\gametp'
2025-10-10T16:35:32.3699317Z [command]"C:\Program Files\Git\bin\git.exe" version
2025-10-10T16:35:32.4958682Z git version 2.51.0.windows.2
2025-10-10T16:35:32.5019388Z ##[endgroup]
2025-10-10T16:35:32.5043640Z Temporarily overriding HOME='D:\a\_temp\387de696-daba-401a-9cb3-57adcf4fa6b7' before making global git config changes
2025-10-10T16:35:32.5045199Z Adding repository directory to the temporary git global config as a safe directory
2025-10-10T16:35:32.5056333Z [command]"C:\Program Files\Git\bin\git.exe" config --global --add safe.directory D:\a\gametp\gametp
2025-10-10T16:35:32.5430768Z Deleting the contents of 'D:\a\gametp\gametp'
2025-10-10T16:35:32.5438506Z ##[group]Initializing the repository
2025-10-10T16:35:32.5449357Z [command]"C:\Program Files\Git\bin\git.exe" init D:\a\gametp\gametp
2025-10-10T16:35:32.6195953Z Initialized empty Git repository in D:/a/gametp/gametp/.git/
2025-10-10T16:35:32.6250883Z [command]"C:\Program Files\Git\bin\git.exe" remote add origin https://github.com/skyoxu/gametp
2025-10-10T16:35:32.6650553Z ##[endgroup]
2025-10-10T16:35:32.6651705Z ##[group]Disabling automatic garbage collection
2025-10-10T16:35:32.6652584Z [command]"C:\Program Files\Git\bin\git.exe" config --local gc.auto 0
2025-10-10T16:35:32.7009274Z ##[endgroup]
2025-10-10T16:35:32.7009942Z ##[group]Setting up auth
2025-10-10T16:35:32.7025523Z [command]"C:\Program Files\Git\bin\git.exe" config --local --name-only --get-regexp core\.sshCommand
2025-10-10T16:35:32.7393960Z [command]"C:\Program Files\Git\bin\git.exe" submodule foreach --recursive "sh -c \"git config --local --name-only --get-regexp 'core\.sshCommand' && git config --local --unset-all 'core.sshCommand' || :\""
2025-10-10T16:35:33.6962862Z [command]"C:\Program Files\Git\bin\git.exe" config --local --name-only --get-regexp http\.https\:\/\/github\.com\/\.extraheader
2025-10-10T16:35:33.7250548Z [command]"C:\Program Files\Git\bin\git.exe" submodule foreach --recursive "sh -c \"git config --local --name-only --get-regexp 'http\.https\:\/\/github\.com\/\.extraheader' && git config --local --unset-all 'http.https://github.com/.extraheader' || :\""
2025-10-10T16:35:34.2994577Z [command]"C:\Program Files\Git\bin\git.exe" config --local http.https://github.com/.extraheader "AUTHORIZATION: basic ***"
2025-10-10T16:35:34.3293172Z ##[endgroup]
2025-10-10T16:35:34.3293682Z ##[group]Fetching the repository
2025-10-10T16:35:34.3308937Z [command]"C:\Program Files\Git\bin\git.exe" -c protocol.version=2 fetch --no-tags --prune --no-recurse-submodules --depth=1 origin +1a64442db4a5e073e50677e36ddf882284d88302:refs/remotes/pull/13/merge
2025-10-10T16:35:35.1450838Z From https://github.com/skyoxu/gametp
2025-10-10T16:35:35.1634672Z  * [new ref]         1a64442db4a5e073e50677e36ddf882284d88302 -> pull/13/merge
2025-10-10T16:35:35.1636612Z ##[endgroup]
2025-10-10T16:35:35.1637295Z ##[group]Determining the checkout info
2025-10-10T16:35:35.1638974Z ##[endgroup]
2025-10-10T16:35:35.1649662Z [command]"C:\Program Files\Git\bin\git.exe" sparse-checkout disable
2025-10-10T16:35:35.1983509Z [command]"C:\Program Files\Git\bin\git.exe" config --local --unset-all extensions.worktreeConfig
2025-10-10T16:35:35.2270272Z ##[group]Checking out the ref
2025-10-10T16:35:35.2280888Z [command]"C:\Program Files\Git\bin\git.exe" checkout --progress --force refs/remotes/pull/13/merge
2025-10-10T16:35:35.4557176Z Note: switching to 'refs/remotes/pull/13/merge'.
2025-10-10T16:35:35.4558044Z 
2025-10-10T16:35:35.4558393Z You are in 'detached HEAD' state. You can look around, make experimental
2025-10-10T16:35:35.4559777Z changes and commit them, and you can discard any commits you make in this
2025-10-10T16:35:35.4560541Z state without impacting any branches by switching back to a branch.
2025-10-10T16:35:35.4560969Z 
2025-10-10T16:35:35.4561261Z If you want to create a new branch to retain commits you create, you may
2025-10-10T16:35:35.4561892Z do so (now or later) by using -c with the switch command. Example:
2025-10-10T16:35:35.4562291Z 
2025-10-10T16:35:35.4562452Z   git switch -c <new-branch-name>
2025-10-10T16:35:35.4562759Z 
2025-10-10T16:35:35.4562889Z Or undo this operation with:
2025-10-10T16:35:35.4563120Z 
2025-10-10T16:35:35.4563228Z   git switch -
2025-10-10T16:35:35.4563389Z 
2025-10-10T16:35:35.4563680Z Turn off this advice by setting config variable advice.detachedHead to false
2025-10-10T16:35:35.4564186Z 
2025-10-10T16:35:35.4564741Z HEAD is now at 1a64442 Merge 49a95a27bfbb9c910dbd39ede44caa8cbfdd17cb into e1a2702b992654c40fdf749cd29695642d416d4b
2025-10-10T16:35:35.4597442Z ##[endgroup]
2025-10-10T16:35:35.4945132Z [command]"C:\Program Files\Git\bin\git.exe" log -1 --format=%H
2025-10-10T16:35:35.5207240Z 1a64442db4a5e073e50677e36ddf882284d88302
2025-10-10T16:35:35.5620528Z ##[group]Run actions/setup-node@v5.0.0
2025-10-10T16:35:35.5620853Z with:
2025-10-10T16:35:35.5621014Z   node-version: 20.x
2025-10-10T16:35:35.5621199Z   cache: npm
2025-10-10T16:35:35.5621365Z   always-auth: false
2025-10-10T16:35:35.5621543Z   check-latest: false
2025-10-10T16:35:35.5621858Z   token: ***
2025-10-10T16:35:35.5622031Z   package-manager-cache: true
2025-10-10T16:35:35.5622225Z env:
2025-10-10T16:35:35.5622367Z   NODE_VERSION_MATRIX: 18.x, 20.x, 22.x
2025-10-10T16:35:35.5622595Z   COVERAGE_THRESHOLD: 90
2025-10-10T16:35:35.5622764Z   SENTRY_DSN: 
2025-10-10T16:35:35.5622923Z   SENTRY_TRACES_SAMPLE_RATE: 0
2025-10-10T16:35:35.5623113Z   CL: /std:c++20 /EHsc
2025-10-10T16:35:35.5623278Z   CXXFLAGS: -std=c++20
2025-10-10T16:35:35.5623448Z   NODE_ENV: development
2025-10-10T16:35:35.5623626Z   NPM_CONFIG_PRODUCTION: false
2025-10-10T16:35:35.5623843Z ##[endgroup]
2025-10-10T16:35:35.7410325Z Found in cache @ C:\hostedtoolcache\windows\node\20.19.5\x64
2025-10-10T16:35:35.7417749Z (node:4712) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
2025-10-10T16:35:35.7418362Z (Use `node --trace-deprecation ...` to show where the warning was created)
2025-10-10T16:35:35.7421336Z ##[group]Environment details
2025-10-10T16:35:39.5539188Z node: v20.19.5
2025-10-10T16:35:39.5539499Z npm: 10.8.2
2025-10-10T16:35:39.5539717Z yarn: 1.22.22
2025-10-10T16:35:39.5541084Z ##[endgroup]
2025-10-10T16:35:39.6341482Z [command]C:\Windows\system32\cmd.exe /D /S /C "C:\hostedtoolcache\windows\node\20.19.5\x64\npm.cmd config get cache"
2025-10-10T16:35:39.9621378Z npm warn config production Use `--omit=dev` instead.
2025-10-10T16:35:40.2083324Z C:\npm\cache
2025-10-10T16:35:40.4422867Z Cache hit for: node-cache-Windows-x64-npm-fc17fb8d376abc8248800f4e980364e44d85f17a5d262a0278bfbe6dc7cc9aee
2025-10-10T16:35:40.4546906Z (node:4712) [DEP0169] DeprecationWarning: `url.parse()` behavior is not standardized and prone to errors that have security implications. Use the WHATWG URL API instead. CVEs are not issued for `url.parse()` vulnerabilities.
2025-10-10T16:35:41.5124437Z Received 134217728 of 315413375 (42.6%), 126.9 MBs/sec
2025-10-10T16:35:42.5127071Z Received 276824064 of 315413375 (87.8%), 131.3 MBs/sec
2025-10-10T16:35:42.7143437Z Received 315413375 of 315413375 (100.0%), 135.9 MBs/sec
2025-10-10T16:35:42.7146720Z Cache Size: ~301 MB (315413375 B)
2025-10-10T16:35:42.7228324Z [command]"C:\Program Files\Git\usr\bin\tar.exe" -xf D:/a/_temp/3371b3f3-a4fc-46fd-b3fc-baeafca002b8/cache.tzst -P -C D:/a/gametp/gametp --force-local --use-compress-program "zstd -d"
2025-10-10T16:35:54.2385701Z Cache restored successfully
2025-10-10T16:35:54.2646164Z Cache restored from key: node-cache-Windows-x64-npm-fc17fb8d376abc8248800f4e980364e44d85f17a5d262a0278bfbe6dc7cc9aee
2025-10-10T16:35:54.3188089Z Prepare all required actions
2025-10-10T16:35:54.3302060Z ##[group]Run ./.github/actions/npm-install
2025-10-10T16:35:54.3302321Z with:
2025-10-10T16:35:54.3302486Z   working-directory: .
2025-10-10T16:35:54.3302667Z   node-version: 20.x
2025-10-10T16:35:54.3302833Z env:
2025-10-10T16:35:54.3302989Z   NODE_VERSION_MATRIX: 18.x, 20.x, 22.x
2025-10-10T16:35:54.3303212Z   COVERAGE_THRESHOLD: 90
2025-10-10T16:35:54.3303388Z   SENTRY_DSN: 
2025-10-10T16:35:54.3303564Z   SENTRY_TRACES_SAMPLE_RATE: 0
2025-10-10T16:35:54.3303758Z   CL: /std:c++20 /EHsc
2025-10-10T16:35:54.3303923Z   CXXFLAGS: -std=c++20
2025-10-10T16:35:54.3304105Z   NODE_ENV: development
2025-10-10T16:35:54.3304293Z   NPM_CONFIG_PRODUCTION: false
2025-10-10T16:35:54.3304480Z ##[endgroup]
2025-10-10T16:35:54.3678112Z ##[group]Run Write-Host "Validating Node.js environment setup..."
2025-10-10T16:35:54.3678907Z [36;1mWrite-Host "Validating Node.js environment setup..."[0m
2025-10-10T16:35:54.3680045Z [36;1mif (-not (Get-Command node -ErrorAction SilentlyContinue)) {[0m
2025-10-10T16:35:54.3680785Z [36;1m  Write-Error "Node.js not found. Ensure actions/setup-node has run."[0m
2025-10-10T16:35:54.3681342Z [36;1m  exit 1[0m
2025-10-10T16:35:54.3681605Z [36;1m}[0m
2025-10-10T16:35:54.3682013Z [36;1mif (-not (Get-Command npm -ErrorAction SilentlyContinue)) {[0m
2025-10-10T16:35:54.3682715Z [36;1m  Write-Error "npm not found. Node.js installation may be incomplete."[0m
2025-10-10T16:35:54.3683272Z [36;1m  exit 1[0m
2025-10-10T16:35:54.3683524Z [36;1m}[0m
2025-10-10T16:35:54.3683898Z [36;1mWrite-Host ("Node.js version: {0}" -f (node --version))[0m
2025-10-10T16:35:54.3684492Z [36;1mWrite-Host ("npm version: {0}" -f (npm --version))[0m
2025-10-10T16:35:54.3978503Z shell: C:\Program Files\PowerShell\7\pwsh.EXE -command ". '{0}'"
2025-10-10T16:35:54.3979089Z env:
2025-10-10T16:35:54.3979358Z   NODE_VERSION_MATRIX: 18.x, 20.x, 22.x
2025-10-10T16:35:54.3979752Z   COVERAGE_THRESHOLD: 90
2025-10-10T16:35:54.3980224Z   SENTRY_DSN: 
2025-10-10T16:35:54.3980554Z   SENTRY_TRACES_SAMPLE_RATE: 0
2025-10-10T16:35:54.3980903Z   CL: /std:c++20 /EHsc
2025-10-10T16:35:54.3981207Z   CXXFLAGS: -std=c++20
2025-10-10T16:35:54.3981503Z   NODE_ENV: development
2025-10-10T16:35:54.3981806Z   NPM_CONFIG_PRODUCTION: false
2025-10-10T16:35:54.3982563Z ##[endgroup]
2025-10-10T16:35:59.8660061Z Validating Node.js environment setup...
2025-10-10T16:35:59.9433054Z Node.js version: v20.19.5
2025-10-10T16:36:00.2566280Z npm warn config production Use `--omit=dev` instead.
2025-10-10T16:36:00.2707648Z npm version: 10.8.2
2025-10-10T16:36:00.6679322Z ##[group]Run Write-Host "Validating critical environment variables..."
2025-10-10T16:36:00.6679769Z [36;1mWrite-Host "Validating critical environment variables..."[0m
2025-10-10T16:36:00.6680162Z [36;1mWrite-Host ("NODE_ENV: {0}" -f ($env:NODE_ENV ?? 'not set'))[0m
2025-10-10T16:36:00.6680626Z [36;1mWrite-Host ("NPM_CONFIG_PRODUCTION: {0}" -f ($env:NPM_CONFIG_PRODUCTION ?? 'not set'))[0m
2025-10-10T16:36:00.6681142Z [36;1mif ($env:NODE_ENV -ne 'development' -or $env:NPM_CONFIG_PRODUCTION -ne 'false') {[0m
2025-10-10T16:36:00.6681853Z [36;1m  Write-Warning "Environment vars may prevent devDependencies installation. Recommended: NODE_ENV=development, NPM_CONFIG_PRODUCTION=false"[0m
2025-10-10T16:36:00.6682415Z [36;1m}[0m
2025-10-10T16:36:00.6748812Z shell: C:\Program Files\PowerShell\7\pwsh.EXE -command ". '{0}'"
2025-10-10T16:36:00.6749135Z env:
2025-10-10T16:36:00.6749303Z   NODE_VERSION_MATRIX: 18.x, 20.x, 22.x
2025-10-10T16:36:00.6749521Z   COVERAGE_THRESHOLD: 90
2025-10-10T16:36:00.6749700Z   SENTRY_DSN: 
2025-10-10T16:36:00.6749869Z   SENTRY_TRACES_SAMPLE_RATE: 0
2025-10-10T16:36:00.6750065Z   CL: /std:c++20 /EHsc
2025-10-10T16:36:00.6750241Z   CXXFLAGS: -std=c++20
2025-10-10T16:36:00.6750423Z   NODE_ENV: development
2025-10-10T16:36:00.6750607Z   NPM_CONFIG_PRODUCTION: false
2025-10-10T16:36:00.6750809Z ##[endgroup]
2025-10-10T16:36:01.0302940Z Validating critical environment variables...
2025-10-10T16:36:01.0310298Z NODE_ENV: development
2025-10-10T16:36:01.0401386Z NPM_CONFIG_PRODUCTION: false
2025-10-10T16:36:01.1476761Z ##[group]Run Write-Host "Starting Windows-focused npm installation..."
2025-10-10T16:36:01.1477302Z [36;1mWrite-Host "Starting Windows-focused npm installation..."[0m
2025-10-10T16:36:01.1477678Z [36;1mWrite-Host ("Runner: {0}" -f $env:RUNNER_OS)[0m
2025-10-10T16:36:01.1478022Z [36;1mWrite-Host "Current npm configuration (subset):"[0m
2025-10-10T16:36:01.1478623Z [36;1mtry { npm config list | Select-String -Pattern 'fetch-retries|registry|fund|audit' -SimpleMatch | ForEach-Object { $_.Line } } catch {}[0m
2025-10-10T16:36:01.1479194Z [36;1m[0m
2025-10-10T16:36:01.1479391Z [36;1m# ESM-friendly npm environment variables[0m
2025-10-10T16:36:01.1479663Z [36;1m$env:NPM_CONFIG_MAXSOCKETS = '8'[0m
2025-10-10T16:36:01.1479904Z [36;1m$env:NPM_CONFIG_FUND = 'false'[0m
2025-10-10T16:36:01.1480390Z [36;1m$env:NPM_CONFIG_AUDIT = 'false'[0m
2025-10-10T16:36:01.1480638Z [36;1m$env:NPM_CONFIG_PROGRESS = 'false'[0m
2025-10-10T16:36:01.1480855Z [36;1m[0m
2025-10-10T16:36:01.1481110Z [36;1m$npmExecutable = (Get-Command npm -ErrorAction Stop).Source[0m
2025-10-10T16:36:01.1481437Z [36;1mif (-not $npmExecutable) {[0m
2025-10-10T16:36:01.1481753Z [36;1m  throw 'npm executable not found on PATH (required for npm ci)'[0m
2025-10-10T16:36:01.1482059Z [36;1m}[0m
2025-10-10T16:36:01.1482202Z [36;1m[0m
2025-10-10T16:36:01.1482476Z [36;1mfunction Invoke-NpmCiAttempt([int]$timeoutSec, [string]$extraArgs) {[0m
2025-10-10T16:36:01.1482899Z [36;1m  $psi = New-Object System.Diagnostics.ProcessStartInfo[0m
2025-10-10T16:36:01.1483216Z [36;1m  $psi.FileName = $npmExecutable[0m
2025-10-10T16:36:01.1483497Z [36;1m  $psi.WorkingDirectory = (Get-Location).Path[0m
2025-10-10T16:36:01.1483773Z [36;1m  $psi.Arguments = "ci $extraArgs"[0m
2025-10-10T16:36:01.1484051Z [36;1m  $psi.RedirectStandardOutput = $true[0m
2025-10-10T16:36:01.1484334Z [36;1m  $psi.RedirectStandardError = $true[0m
2025-10-10T16:36:01.1484595Z [36;1m  $psi.UseShellExecute = $false[0m
2025-10-10T16:36:01.1484837Z [36;1m  $psi.CreateNoWindow = $true[0m
2025-10-10T16:36:01.1485117Z [36;1m  $proc = New-Object System.Diagnostics.Process[0m
2025-10-10T16:36:01.1485395Z [36;1m  $proc.StartInfo = $psi[0m
2025-10-10T16:36:01.1485605Z [36;1m  [void]$proc.Start()[0m
2025-10-10T16:36:01.1486226Z [36;1m  $completed = $proc.WaitForExit($timeoutSec * 1000)[0m
2025-10-10T16:36:01.1486550Z [36;1m  $out = $proc.StandardOutput.ReadToEnd()[0m
2025-10-10T16:36:01.1486845Z [36;1m  $err = $proc.StandardError.ReadToEnd()[0m
2025-10-10T16:36:01.1487201Z [36;1m  ($out + $err) | Out-File -FilePath npm_install.log -Append -Encoding UTF8[0m
2025-10-10T16:36:01.1487881Z [36;1m  if (-not $completed) { try { Stop-Process -Id $proc.Id -Force -ErrorAction SilentlyContinue } catch {}; return @{ Ok=$false; TimedOut=$true; Code=-1 } }[0m
2025-10-10T16:36:01.1488551Z [36;1m  return @{ Ok = ($proc.ExitCode -eq 0); TimedOut=$false; Code=$proc.ExitCode }[0m
2025-10-10T16:36:01.1488890Z [36;1m}[0m
2025-10-10T16:36:01.1489032Z [36;1m[0m
2025-10-10T16:36:01.1489188Z [36;1m$attempts = @([0m
2025-10-10T16:36:01.1489385Z [36;1m  @{ Timeout=480; Args='' },[0m
2025-10-10T16:36:01.1489722Z [36;1m  @{ Timeout=720; Args='--maxsockets=5' },[0m
2025-10-10T16:36:01.1490108Z [36;1m  @{ Timeout=900; Args='--maxsockets=1' },[0m
2025-10-10T16:36:01.1490348Z [36;1m  @{ Timeout=900; Args='' }[0m
2025-10-10T16:36:01.1490549Z [36;1m)[0m
2025-10-10T16:36:01.1490686Z [36;1m[0m
2025-10-10T16:36:01.1490838Z [36;1m$success = $false[0m
2025-10-10T16:36:01.1491062Z [36;1mfor ($i=0; $i -lt $attempts.Count; $i++) {[0m
2025-10-10T16:36:01.1491306Z [36;1m  $a = $attempts[$i][0m
2025-10-10T16:36:01.1491637Z [36;1m  Write-Host ("Attempt {0} (timeout={1}s args='{2}')" -f ($i+1), $a.Timeout, $a.Args)[0m
2025-10-10T16:36:01.1493046Z [36;1m  $res = Invoke-NpmCiAttempt -timeoutSec $a.Timeout -extraArgs $a.Args[0m
2025-10-10T16:36:01.1493470Z [36;1m  if ($res.Ok) { $success = $true; break } else {[0m
2025-10-10T16:36:01.1493764Z [36;1m    if ($i -lt ($attempts.Count-1)) {[0m
2025-10-10T16:36:01.1494017Z [36;1m      $sleep = 15 * ($i+1)[0m
2025-10-10T16:36:01.1494499Z [36;1m      Write-Warning ("Attempt {0} failed (code={1}, timeout={2}). Sleeping {3}s before retry..." -f ($i+1), $res.Code, $res.TimedOut, $sleep)[0m
2025-10-10T16:36:01.1495008Z [36;1m      Start-Sleep -Seconds $sleep[0m
2025-10-10T16:36:01.1495235Z [36;1m    }[0m
2025-10-10T16:36:01.1495387Z [36;1m  }[0m
2025-10-10T16:36:01.1495524Z [36;1m}[0m
2025-10-10T16:36:01.1495669Z [36;1m[0m
2025-10-10T16:36:01.1495826Z [36;1mif (-not $success) {[0m
2025-10-10T16:36:01.1496160Z [36;1m  Write-Error "CRITICAL FAILURE: All Windows installation attempts failed!"[0m
2025-10-10T16:36:01.1496656Z [36;1m  if (Test-Path npm_install.log) { Get-Content npm_install.log -Tail 80 | Write-Host }[0m
2025-10-10T16:36:01.1497679Z [36;1m  exit 1[0m
2025-10-10T16:36:01.1497838Z [36;1m}[0m
2025-10-10T16:36:01.1497977Z [36;1m[0m
2025-10-10T16:36:01.1498163Z [36;1mWrite-Host "SUCCESS: npm ci completed"[0m
2025-10-10T16:36:01.1498515Z [36;1m[0m
2025-10-10T16:36:01.1498674Z [36;1m# Verification[0m
2025-10-10T16:36:01.1498867Z [36;1m$verificationErrors = 0[0m
2025-10-10T16:36:01.1499143Z [36;1m$tools = @('eslint','tsc','vitest','playwright','tsx')[0m
2025-10-10T16:36:01.1499426Z [36;1mforeach ($t in $tools) {[0m
2025-10-10T16:36:01.1499685Z [36;1m  $binPath = Join-Path 'node_modules/.bin' $t[0m
2025-10-10T16:36:01.1500019Z [36;1m  $binCmdPath = Join-Path 'node_modules/.bin' ("{0}.cmd" -f $t)[0m
2025-10-10T16:36:01.1500339Z [36;1m  $hasTool = Test-Path $binPath[0m
2025-10-10T16:36:01.1500589Z [36;1m  if (-not $hasTool) {[0m
2025-10-10T16:36:01.1500816Z [36;1m    $hasTool = Test-Path $binCmdPath[0m
2025-10-10T16:36:01.1501052Z [36;1m  }[0m
2025-10-10T16:36:01.1501223Z [36;1m  if ($hasTool) {[0m
2025-10-10T16:36:01.1501498Z [36;1m    Write-Host ("SUCCESS: {0} available in node_modules/.bin" -f $t)[0m
2025-10-10T16:36:01.1501855Z [36;1m  } elseif ((npm list $t | Out-Null) -ne $true) {[0m
2025-10-10T16:36:01.1502185Z [36;1m    Write-Warning ("{0} not detected in node_modules" -f $t)[0m
2025-10-10T16:36:01.1502482Z [36;1m    $verificationErrors++[0m
2025-10-10T16:36:01.1502678Z [36;1m  }[0m
2025-10-10T16:36:01.1502822Z [36;1m}[0m
2025-10-10T16:36:01.1502960Z [36;1m[0m
2025-10-10T16:36:01.1503212Z [36;1mWrite-Host "Verifying Rollup native platform package for Windows..."[0m
2025-10-10T16:36:01.1503627Z [36;1mnode -e "require('@rollup/rollup-win32-x64-msvc')" 2>$null[0m
2025-10-10T16:36:01.1504212Z [36;1mif ($LASTEXITCODE -eq 0) { Write-Host "SUCCESS: rollup native ok" } else { Write-Warning "rollup native package not found (non-critical)" }[0m
2025-10-10T16:36:01.1504710Z [36;1m[0m
2025-10-10T16:36:01.1504904Z [36;1m$hasNodeModules = Test-Path 'node_modules'[0m
2025-10-10T16:36:01.1505219Z [36;1m$hasNodeModulesBin = Test-Path 'node_modules/.bin'[0m
2025-10-10T16:36:01.1505544Z [36;1mif ($hasNodeModules -and $hasNodeModulesBin) {[0m
2025-10-10T16:36:01.1506198Z [36;1m  $pkgCount = (Get-ChildItem 'node_modules' -Directory | Measure-Object).Count[0m
2025-10-10T16:36:01.1506767Z [36;1m  Write-Host ("SUCCESS: node_modules verification passed ({0} top-level packages)" -f $pkgCount)[0m
2025-10-10T16:36:01.1507172Z [36;1m} else {[0m
2025-10-10T16:36:01.1507413Z [36;1m  Write-Error 'node_modules structure verification failed'[0m
2025-10-10T16:36:01.1507712Z [36;1m  $verificationErrors++[0m
2025-10-10T16:36:01.1507914Z [36;1m}[0m
2025-10-10T16:36:01.1508052Z [36;1m[0m
2025-10-10T16:36:01.1508182Z [36;1mtry {[0m
2025-10-10T16:36:01.1508421Z [36;1m  $pkg = Get-Content package.json -Raw | ConvertFrom-Json[0m
2025-10-10T16:36:01.1509025Z [36;1m  if ($pkg.type -eq 'module') { Write-Host 'SUCCESS: ESM module system verification passed' }[0m
2025-10-10T16:36:01.1509406Z [36;1m} catch {}[0m
2025-10-10T16:36:01.1509562Z [36;1m[0m
2025-10-10T16:36:01.1510175Z [36;1mif ($verificationErrors -gt 0) { Write-Warning ("Found {0} verification issues (non-blocking)" -f $verificationErrors) }[0m
2025-10-10T16:36:01.1588316Z shell: C:\Program Files\PowerShell\7\pwsh.EXE -command ". '{0}'"
2025-10-10T16:36:01.1588663Z env:
2025-10-10T16:36:01.1588852Z   NODE_VERSION_MATRIX: 18.x, 20.x, 22.x
2025-10-10T16:36:01.1589083Z   COVERAGE_THRESHOLD: 90
2025-10-10T16:36:01.1589263Z   SENTRY_DSN: 
2025-10-10T16:36:01.1589429Z   SENTRY_TRACES_SAMPLE_RATE: 0
2025-10-10T16:36:01.1589629Z   CL: /std:c++20 /EHsc
2025-10-10T16:36:01.1589802Z   CXXFLAGS: -std=c++20
2025-10-10T16:36:01.1589987Z   NODE_ENV: development
2025-10-10T16:36:01.1590177Z   NPM_CONFIG_PRODUCTION: false
2025-10-10T16:36:01.1590381Z ##[endgroup]
2025-10-10T16:36:01.5995175Z Starting Windows-focused npm installation...
2025-10-10T16:36:01.6007763Z Runner: Windows
2025-10-10T16:36:01.6016129Z Current npm configuration (subset):
2025-10-10T16:36:01.9539836Z npm warn config production Use `--omit=dev` instead.
2025-10-10T16:36:02.0567504Z Attempt 1 (timeout=480s args='')
2025-10-10T16:37:24.4979717Z SUCCESS: npm ci completed
2025-10-10T16:37:24.5103111Z SUCCESS: eslint available in node_modules/.bin
2025-10-10T16:37:24.5116790Z SUCCESS: tsc available in node_modules/.bin
2025-10-10T16:37:24.5156419Z SUCCESS: vitest available in node_modules/.bin
2025-10-10T16:37:24.5801697Z SUCCESS: playwright available in node_modules/.bin
2025-10-10T16:37:24.5865915Z SUCCESS: tsx available in node_modules/.bin
2025-10-10T16:37:24.5901272Z Verifying Rollup native platform package for Windows...
2025-10-10T16:37:24.6608990Z SUCCESS: rollup native ok
2025-10-10T16:37:24.7096794Z SUCCESS: node_modules verification passed (1172 top-level packages)
2025-10-10T16:37:24.7319769Z SUCCESS: ESM module system verification passed
2025-10-10T16:37:24.8555893Z Prepare all required actions
2025-10-10T16:37:24.8622191Z ##[group]Run ./.github/actions/run-tests
2025-10-10T16:37:24.8622430Z with:
2025-10-10T16:37:24.8622582Z   test-type: coverage
2025-10-10T16:37:24.8622762Z   timeout: 300000
2025-10-10T16:37:24.8622913Z   fail-fast: true
2025-10-10T16:37:24.8623075Z   reporter: default
2025-10-10T16:37:24.8623234Z env:
2025-10-10T16:37:24.8623385Z   NODE_VERSION_MATRIX: 18.x, 20.x, 22.x
2025-10-10T16:37:24.8623616Z   COVERAGE_THRESHOLD: 90
2025-10-10T16:37:24.8623804Z   SENTRY_DSN: 
2025-10-10T16:37:24.8623966Z   SENTRY_TRACES_SAMPLE_RATE: 0
2025-10-10T16:37:24.8624165Z   CL: /std:c++20 /EHsc
2025-10-10T16:37:24.8624340Z   CXXFLAGS: -std=c++20
2025-10-10T16:37:24.8624507Z   NODE_ENV: test
2025-10-10T16:37:24.8624681Z   NPM_CONFIG_PRODUCTION: false
2025-10-10T16:37:24.8624876Z ##[endgroup]
2025-10-10T16:37:24.8782060Z ##[group]Run node scripts/ci/run-tests.mjs --test-type "coverage" --timeout "300000" --fail-fast "true" --reporter "default" --output-file ""
2025-10-10T16:37:24.8782886Z [36;1mnode scripts/ci/run-tests.mjs --test-type "coverage" --timeout "300000" --fail-fast "true" --reporter "default" --output-file ""[0m
2025-10-10T16:37:24.8860739Z shell: C:\Program Files\PowerShell\7\pwsh.EXE -command ". '{0}'"
2025-10-10T16:37:24.8861112Z env:
2025-10-10T16:37:24.8861292Z   NODE_VERSION_MATRIX: 18.x, 20.x, 22.x
2025-10-10T16:37:24.8861528Z   COVERAGE_THRESHOLD: 90
2025-10-10T16:37:24.8861713Z   SENTRY_DSN: 
2025-10-10T16:37:24.8861876Z   SENTRY_TRACES_SAMPLE_RATE: 0
2025-10-10T16:37:24.8862080Z   CL: /std:c++20 /EHsc
2025-10-10T16:37:24.8862263Z   CXXFLAGS: -std=c++20
2025-10-10T16:37:24.8862432Z   NODE_ENV: test
2025-10-10T16:37:24.8862609Z   NPM_CONFIG_PRODUCTION: false
2025-10-10T16:37:24.8862804Z ##[endgroup]
2025-10-10T16:37:25.2763131Z [run-tests] Start type=coverage
2025-10-10T16:37:25.2768588Z [run-tests] Timeout=300000ms, FailFast=true, Reporter=default
2025-10-10T16:37:25.2770601Z [run-tests] Executing: npm run test:coverage
2025-10-10T16:37:54.1791716Z 
2025-10-10T16:37:54.1792980Z > gametp@0.1.0 test:coverage
2025-10-10T16:37:54.1793717Z > vitest run --coverage
2025-10-10T16:37:54.1794052Z 
2025-10-10T16:37:54.1794060Z 
2025-10-10T16:37:54.1795220Z [1m[46m RUN [49m[22m [36mv3.2.4 [39m[90mD:/a/gametp/gametp[39m
2025-10-10T16:37:54.1796324Z       [2mCoverage enabled with [22m[33mv8[39m
2025-10-10T16:37:54.1796670Z 
2025-10-10T16:37:54.1797072Z [90mstdout[2m | tests/unit/risk.spec.ts
2025-10-10T16:37:54.1797851Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1798165Z 
2025-10-10T16:37:54.1798500Z [90mstdout[2m | tests/unit/metrics.spec.ts
2025-10-10T16:37:54.1799073Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1799448Z 
2025-10-10T16:37:54.1800097Z [90mstdout[2m | src/shared/adapters/sqlite.bak/__tests__/config-manager.spec.ts
2025-10-10T16:37:54.1800781Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1801098Z 
2025-10-10T16:37:54.1802350Z  [32m✓[39m tests/unit/risk.spec.ts [2m([22m[2m29 tests[22m[2m)[22m[32m 42[2mms[22m[39m
2025-10-10T16:37:54.1803272Z  [32m✓[39m tests/unit/metrics.spec.ts [2m([22m[2m40 tests[22m[2m)[22m[32m 42[2mms[22m[39m
2025-10-10T16:37:54.1804581Z  [32m✓[39m src/shared/adapters/sqlite.bak/__tests__/config-manager.spec.ts [2m([22m[2m33 tests[22m[2m)[22m[32m 37[2mms[22m[39m
2025-10-10T16:37:54.1805364Z [90mstdout[2m | tests/unit/release.feed.spec.ts
2025-10-10T16:37:54.1805830Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1806042Z 
2025-10-10T16:37:54.1806271Z [90mstdout[2m | tests/unit/runtime.budget.spec.ts
2025-10-10T16:37:54.1806733Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1806966Z 
2025-10-10T16:37:54.1807158Z [90mstdout[2m | tests/unit/glossary.spec.ts
2025-10-10T16:37:54.1807582Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1807783Z 
2025-10-10T16:37:54.1811012Z  [32m✓[39m tests/unit/runtime.budget.spec.ts [2m([22m[2m27 tests[22m[2m)[22m[32m 15[2mms[22m[39m
2025-10-10T16:37:54.1812020Z  [32m✓[39m tests/unit/glossary.spec.ts [2m([22m[2m40 tests[22m[2m)[22m[32m 42[2mms[22m[39m
2025-10-10T16:37:54.1812731Z [90mstdout[2m | src/shared/services/__tests__/event-bus.spec.ts
2025-10-10T16:37:54.1816051Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1816479Z 
2025-10-10T16:37:54.1817028Z [90mstdout[2m | tests/unit/repos.contract.spec.ts
2025-10-10T16:37:54.1819610Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1819983Z 
2025-10-10T16:37:54.1820535Z  [32m✓[39m src/shared/services/__tests__/event-bus.spec.ts [2m([22m[2m23 tests[22m[2m)[22m[32m 34[2mms[22m[39m
2025-10-10T16:37:54.1821911Z  [32m✓[39m tests/unit/repos.contract.spec.ts [2m([22m[2m17 tests[22m[2m)[22m[32m 21[2mms[22m[39m
2025-10-10T16:37:54.1823136Z  [32m✓[39m tests/unit/release.feed.spec.ts [2m([22m[2m13 tests[22m[2m)[22m[33m 2724[2mms[22m[39m
2025-10-10T16:37:54.1824717Z    [33m[2m✓[22m[39m Release Feed Management[2m > [22mpatch-staging-percentage[2m > [22mshould handle percentage boundary values [33m 554[2mms[22m[39m
2025-10-10T16:37:54.1826565Z    [33m[2m✓[22m[39m Release Feed Management[2m > [22mStaged Rollout Integration[2m > [22mshould handle full staged rollout lifecycle [33m 447[2mms[22m[39m
2025-10-10T16:37:54.1827756Z [90mstdout[2m | src/game/__tests__/GameStateManager.test.ts
2025-10-10T16:37:54.1828462Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1828768Z 
2025-10-10T16:37:54.1829048Z [90mstdout[2m | tests/unit/gates.spec.ts
2025-10-10T16:37:54.1829675Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1830022Z 
2025-10-10T16:37:54.1830567Z  [32m✓[39m tests/unit/gates.spec.ts [2m([22m[2m16 tests[22m[2m)[22m[32m 17[2mms[22m[39m
2025-10-10T16:37:54.1831787Z  [32m✓[39m src/game/__tests__/GameStateManager.test.ts [2m([22m[2m21 tests[22m[2m)[22m[32m 133[2mms[22m[39m
2025-10-10T16:37:54.1832804Z [90mstdout[2m | src/core/events/bus.test.ts
2025-10-10T16:37:54.1833751Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1834156Z 
2025-10-10T16:37:54.1834789Z  [32m✓[39m src/core/events/bus.test.ts [2m([22m[2m19 tests[22m[2m)[22m[32m 288[2mms[22m[39m
2025-10-10T16:37:54.1835889Z [90mstdout[2m | tests/unit/middleware/cloudevents-validation.spec.ts
2025-10-10T16:37:54.1836871Z npm warn config production Use `--omit=dev` instead.
2025-10-10T16:37:54.1837581Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1837895Z 
2025-10-10T16:37:54.1838377Z [90mstdout[2m | src/game/__tests__/GameEngineAdapter.test.ts
2025-10-10T16:37:54.1839087Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1839426Z 
2025-10-10T16:37:54.1840290Z  [32m✓[39m tests/unit/middleware/cloudevents-validation.spec.ts [2m([22m[2m17 tests[22m[2m)[22m[32m 37[2mms[22m[39m
2025-10-10T16:37:54.1841851Z [90mstdout[2m | tests/unit/db.checkpoint.spec.ts
2025-10-10T16:37:54.1842474Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1842759Z 
2025-10-10T16:37:54.1843480Z  [32m✓[39m src/game/__tests__/GameEngineAdapter.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 220[2mms[22m[39m
2025-10-10T16:37:54.1844941Z  [32m✓[39m tests/unit/db.checkpoint.spec.ts [2m([22m[2m7 tests[22m[2m | [22m[33m1 skipped[39m[2m)[22m[33m 1120[2mms[22m[39m
2025-10-10T16:37:54.1846148Z [90mstdout[2m | src/shared/middleware/__tests__/cloud-events-validator.spec.ts
2025-10-10T16:37:54.1847019Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1847370Z 
2025-10-10T16:37:54.1848244Z  [32m✓[39m src/shared/middleware/__tests__/cloud-events-validator.spec.ts [2m([22m[2m19 tests[22m[2m)[22m[32m 21[2mms[22m[39m
2025-10-10T16:37:54.1849474Z [90mstdout[2m | tests/unit/perf.budget.spec.ts
2025-10-10T16:37:54.1851745Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1852182Z 
2025-10-10T16:37:54.1852929Z  [32m✓[39m tests/unit/perf.budget.spec.ts [2m([22m[2m17 tests[22m[2m)[22m[32m 16[2mms[22m[39m
2025-10-10T16:37:54.1854224Z [90mstdout[2m | tests/unit/db.backup.spec.ts
2025-10-10T16:37:54.1854948Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1855285Z 
2025-10-10T16:37:54.1855737Z [90mstdout[2m | src/game/__tests__/SceneManager.test.ts
2025-10-10T16:37:54.1856479Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1856797Z 
2025-10-10T16:37:54.1857517Z  [2m[90m↓[39m[22m tests/unit/db.backup.spec.ts [2m([22m[2m6 tests[22m[2m | [22m[33m6 skipped[39m[2m)[22m
2025-10-10T16:37:54.1858805Z  [32m✓[39m src/game/__tests__/SceneManager.test.ts [2m([22m[2m18 tests[22m[2m)[22m[32m 295[2mms[22m[39m
2025-10-10T16:37:54.1859817Z [90mstdout[2m | tests/unit/contracts/cloudevents.spec.ts
2025-10-10T16:37:54.1860562Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1860894Z 
2025-10-10T16:37:54.1861642Z  [32m✓[39m tests/unit/contracts/cloudevents.spec.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 28[2mms[22m[39m
2025-10-10T16:37:54.1862677Z [90mstdout[2m | src/__tests__/p95-sampling-demo.test.ts
2025-10-10T16:37:54.1863389Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1863715Z 
2025-10-10T16:37:54.1864074Z [90mstdout[2m | src/__tests__/performance-utils.test.ts
2025-10-10T16:37:54.1864768Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1865076Z 
2025-10-10T16:37:54.1865473Z [90mstdout[2m | tests/unit/electron/security.spec.ts
2025-10-10T16:37:54.1866150Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1866502Z 
2025-10-10T16:37:54.1867172Z  [32m✓[39m tests/unit/electron/security.spec.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 8[2mms[22m[39m
2025-10-10T16:37:54.1868475Z  [32m✓[39m src/__tests__/p95-sampling-demo.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 10[2mms[22m[39m
2025-10-10T16:37:54.1869460Z [90mstdout[2m | tests/unit/fuses.verify.spec.ts
2025-10-10T16:37:54.1870097Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1870427Z 
2025-10-10T16:37:54.1871077Z  [32m✓[39m tests/unit/fuses.verify.spec.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 67[2mms[22m[39m
2025-10-10T16:37:54.1872241Z  [32m✓[39m src/__tests__/performance-utils.test.ts [2m([22m[2m8 tests[22m[2m)[22m[33m 732[2mms[22m[39m
2025-10-10T16:37:54.1874258Z    [33m[2m✓[22m[39m P95 性能测试工具[2m > [22mPerformanceTestUtils 工厂方法[2m > [22mrunP95Test 应该执行指定次数的采样 [33m 509[2mms[22m[39m
2025-10-10T16:37:54.1875230Z [90mstdout[2m | src/App.test.tsx
2025-10-10T16:37:54.1875879Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1876205Z 
2025-10-10T16:37:54.1876591Z [90mstdout[2m | src/shared/contracts/events.spec.ts
2025-10-10T16:37:54.1877252Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1877562Z 
2025-10-10T16:37:54.1879388Z  [32m✓[39m src/shared/contracts/events.spec.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 8[2mms[22m[39m
2025-10-10T16:37:54.1880522Z  [32m✓[39m src/App.test.tsx [2m([22m[2m6 tests[22m[2m)[22m[32m 247[2mms[22m[39m
2025-10-10T16:37:54.1881334Z [90mstdout[2m | tests/unit/ci/guard-tests-ascii.spec.ts
2025-10-10T16:37:54.1882020Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1882346Z 
2025-10-10T16:37:54.1883066Z  [32m✓[39m tests/unit/ci/guard-tests-ascii.spec.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 215[2mms[22m[39m
2025-10-10T16:37:54.1884012Z [90mstdout[2m | tests/unit/fuses.evaluate.spec.ts
2025-10-10T16:37:54.1884715Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1885067Z 
2025-10-10T16:37:54.1885428Z [90mstdout[2m | tests/unit/ci/fix-bom-tests.spec.ts
2025-10-10T16:37:54.1886122Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1886410Z 
2025-10-10T16:37:54.1887270Z  [32m✓[39m tests/unit/fuses.evaluate.spec.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 93[2mms[22m[39m
2025-10-10T16:37:54.1888531Z  [32m✓[39m tests/unit/ci/fix-bom-tests.spec.ts [2m([22m[2m1 test[22m[2m)[22m[32m 112[2mms[22m[39m
2025-10-10T16:37:54.1889641Z [90mstdout[2m | tests/unit/observability/sentry-scrub.spec.ts
2025-10-10T16:37:54.1890388Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1890693Z 
2025-10-10T16:37:54.1891467Z  [32m✓[39m tests/unit/observability/sentry-scrub.spec.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 6[2mms[22m[39m
2025-10-10T16:37:54.1892463Z [90mstdout[2m | tests/unit/validation.spec.ts
2025-10-10T16:37:54.1893067Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1893429Z 
2025-10-10T16:37:54.1894348Z  [32m✓[39m tests/unit/validation.spec.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 11[2mms[22m[39m
2025-10-10T16:37:54.1895369Z [90mstdout[2m | tests/unit/security.params.spec.ts
2025-10-10T16:37:54.1896096Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1896445Z 
2025-10-10T16:37:54.1897141Z  [32m✓[39m tests/unit/security.params.spec.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 7[2mms[22m[39m
2025-10-10T16:37:54.1898117Z [90mstdout[2m | tests/unit/events/contracts.spec.ts
2025-10-10T16:37:54.1898814Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1899165Z 
2025-10-10T16:37:54.1899821Z  [32m✓[39m tests/unit/events/contracts.spec.ts [2m([22m[2m1 test[22m[2m)[22m[32m 7[2mms[22m[39m
2025-10-10T16:37:54.1900860Z [90mstdout[2m | src/tests/docs-scorer-performance.test.mjs
2025-10-10T16:37:54.1901621Z [22m[39mVitest test environment initialized
2025-10-10T16:37:54.1901939Z 
2025-10-10T16:37:54.1902688Z  [32m✓[39m src/tests/docs-scorer-performance.test.mjs [2m([22m[2m6 tests[22m[2m)[22m[33m 748[2mms[22m[39m
2025-10-10T16:37:54.1903339Z 
2025-10-10T16:37:54.1903678Z [2m  Snapshots [22m [1m[33m1 obsolete[39m[22m
2025-10-10T16:37:54.1904564Z [2m            [22m [90m↳[39m [2msrc/[22m[1mApp[22m[2m.test.tsx[22m
2025-10-10T16:37:54.1905532Z [2m            [22m   [90m·[39m App 组件 > 快照测试 > 应该匹配快照 1
2025-10-10T16:37:54.1905845Z 
2025-10-10T16:37:54.1906486Z [2m Test Files [22m [1m[32m32 passed[39m[22m[2m | [22m[33m1 skipped[39m[90m (33)[39m
2025-10-10T16:37:54.1907593Z [2m      Tests [22m [1m[32m428 passed[39m[22m[2m | [22m[33m7 skipped[39m[90m (435)[39m
2025-10-10T16:37:54.1908330Z [2m   Start at [22m 16:37:26
2025-10-10T16:37:54.1909437Z [2m   Duration [22m 27.29s[2m (transform 1.41s, setup 11.36s, collect 6.29s, tests 7.40s, environment 34.06s, prepare 6.68s)[22m
2025-10-10T16:37:54.1910130Z 
2025-10-10T16:37:54.1910483Z [34m % [39m[2mCoverage report from [22m[33mv8[39m
2025-10-10T16:37:54.1911201Z -------------------|---------|----------|---------|---------|-------------------
2025-10-10T16:37:54.1911929Z File               | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s 
2025-10-10T16:37:54.1912976Z -------------------|---------|----------|---------|---------|-------------------
2025-10-10T16:37:54.1913732Z All files          |   74.91 |    79.65 |   77.28 |   74.91 |                   
2025-10-10T16:37:54.1914804Z  electron          |      22 |    42.85 |      30 |      22 |                   
2025-10-10T16:37:54.1915454Z   security.ts      |      22 |    42.85 |      30 |      22 | ...17-318,321-322 
2025-10-10T16:37:54.1915938Z  scripts           |    73.7 |    70.88 |      80 |    73.7 |                   
2025-10-10T16:37:54.1916373Z   docs-scorer.mjs  |   75.32 |    72.85 |    87.5 |   75.32 | ...68-612,619-620 
2025-10-10T16:37:54.1916810Z   fuses.js         |   66.66 |    55.55 |      50 |   66.66 | ...08-110,137-139 
2025-10-10T16:37:54.1917243Z  src/core/events   |     100 |    93.33 |     100 |     100 |                   
2025-10-10T16:37:54.1917775Z   bus.ts           |     100 |    93.33 |     100 |     100 | 41                
2025-10-10T16:37:54.1918663Z  src/game          |   72.63 |    80.18 |   85.45 |   72.63 |                   
2025-10-10T16:37:54.1919107Z   ...ineAdapter.ts |   65.09 |    79.54 |   74.19 |   65.09 | ...96-621,650-731 
2025-10-10T16:37:54.1919568Z   SceneManager.ts  |    91.4 |    80.59 |     100 |    91.4 | ...53,272-273,325 
2025-10-10T16:37:54.1920110Z  ...ts__/__mocks__ |     100 |      100 |      60 |     100 |                   
2025-10-10T16:37:54.1920502Z   phaser.ts        |     100 |      100 |      60 |     100 |                   
2025-10-10T16:37:54.1920933Z  src/game/assets   |   36.84 |      100 |       0 |   36.84 |                   
2025-10-10T16:37:54.1921311Z   ...e-pipeline.ts |   36.84 |      100 |       0 |   36.84 | 26-38             
2025-10-10T16:37:54.1921693Z  src/game/state    |   63.79 |    79.68 |   71.79 |   63.79 |                   
2025-10-10T16:37:54.1922069Z   ...ateManager.ts |   84.53 |    83.67 |     100 |   84.53 | ...80-389,417-418 
2025-10-10T16:37:54.1922455Z   ...nchronizer.ts |   42.08 |    66.66 |      45 |   42.08 | ...96-397,407-408 
2025-10-10T16:37:54.1922825Z  src/runtime       |      96 |    71.42 |     100 |      96 |                   
2025-10-10T16:37:54.1923162Z   loop.ts          |   93.75 |       70 |     100 |   93.75 | 26-27             
2025-10-10T16:37:54.1923488Z   state.ts         |     100 |       75 |     100 |     100 | 17                
2025-10-10T16:37:54.1924013Z  ...ers/sqlite.bak |   95.42 |     83.6 |     100 |   95.42 |                   
2025-10-10T16:37:54.1924561Z   ...ig-manager.ts |   95.42 |     83.6 |     100 |   95.42 | ...13-416,421-422 
2025-10-10T16:37:54.1924945Z  ...ared/contracts |   91.38 |    86.02 |   71.42 |   91.38 |                   
2025-10-10T16:37:54.1925305Z   build.ts         |   98.16 |    71.42 |     100 |   98.16 | 236,244           
2025-10-10T16:37:54.1925655Z   ...vents-core.ts |   64.63 |      100 |   44.44 |   64.63 | ...34-136,139-142 
2025-10-10T16:37:54.1926022Z   events.ts        |   84.37 |    65.38 |   55.55 |   84.37 | ...73-375,383-385 
2025-10-10T16:37:54.1926384Z   glossary.ts      |   99.09 |      100 |   85.71 |   99.09 | 372-373           
2025-10-10T16:37:54.1926740Z   metrics.ts       |   95.43 |    85.18 |   83.33 |   95.43 | 263-267,272-280   
2025-10-10T16:37:54.1927092Z   perf.ts          |     100 |      100 |     100 |     100 |                   
2025-10-10T16:37:54.1927431Z   repos.ts         |   69.44 |      100 |      50 |   69.44 | ...52-359,403-409 
2025-10-10T16:37:54.1927773Z   runtime.ts       |   95.23 |     82.6 |     100 |   95.23 | 214-215,223-224   
2025-10-10T16:37:54.1928127Z   validation.js    |     100 |      100 |     100 |     100 |                   
2025-10-10T16:37:54.1928505Z  ...ntracts/events |     100 |      100 |     100 |     100 |                   
2025-10-10T16:37:54.1928884Z   GameEvents.ts    |     100 |      100 |     100 |     100 |                   
2025-10-10T16:37:54.1929267Z  src/shared/events |   42.29 |    46.15 |   42.85 |   42.29 |                   
2025-10-10T16:37:54.1929867Z   EventBus.ts      |   42.29 |    46.15 |   42.85 |   42.29 | ...43-345,351-353 
2025-10-10T16:37:54.1930247Z  ...red/middleware |   73.47 |    85.57 |   86.84 |   73.47 |                   
2025-10-10T16:37:54.1930655Z   ...-validator.ts |   93.98 |    88.13 |     100 |   93.98 | ...52-253,265-266 
2025-10-10T16:37:54.1931032Z   ...validation.ts |   62.46 |    82.22 |      80 |   62.46 | ...27-472,479-503 
2025-10-10T16:37:54.1931402Z  ...hared/services |   84.97 |    81.57 |     100 |   84.97 |                   
2025-10-10T16:37:54.1931785Z   event-bus.ts     |   84.97 |    81.57 |     100 |   84.97 | ...11-212,292-303 
2025-10-10T16:37:54.1932151Z  tests/utils       |   50.95 |    78.78 |   66.66 |   50.95 |                   
2025-10-10T16:37:54.1932527Z   ...eTestUtils.ts |   50.95 |    78.78 |   66.66 |   50.95 | ...85-200,213-239 
2025-10-10T16:37:54.1932941Z -------------------|---------|----------|---------|---------|-------------------
2025-10-10T16:37:54.1934222Z [run-tests] Completed: PASS
2025-10-10T16:37:54.3276346Z ##[group]Run if ('success' -eq 'success') {
2025-10-10T16:37:54.3276678Z [36;1mif ('success' -eq 'success') {[0m
2025-10-10T16:37:54.3276942Z [36;1m  Write-Host '[tests] Status: PASS'[0m
2025-10-10T16:37:54.3277179Z [36;1m} else {[0m
2025-10-10T16:37:54.3277369Z [36;1m  Write-Host '[tests] Status: FAIL'[0m
2025-10-10T16:37:54.3277600Z [36;1m}[0m
2025-10-10T16:37:54.3277769Z [36;1mif ('coverage/' -ne '') {[0m
2025-10-10T16:37:54.3278039Z [36;1m  Write-Host "[tests] Report path: coverage/"[0m
2025-10-10T16:37:54.3278295Z [36;1m}[0m
2025-10-10T16:37:54.3354998Z shell: C:\Program Files\PowerShell\7\pwsh.EXE -command ". '{0}'"
2025-10-10T16:37:54.3355340Z env:
2025-10-10T16:37:54.3355518Z   NODE_VERSION_MATRIX: 18.x, 20.x, 22.x
2025-10-10T16:37:54.3355755Z   COVERAGE_THRESHOLD: 90
2025-10-10T16:37:54.3355944Z   SENTRY_DSN: 
2025-10-10T16:37:54.3356109Z   SENTRY_TRACES_SAMPLE_RATE: 0
2025-10-10T16:37:54.3356337Z   CL: /std:c++20 /EHsc
2025-10-10T16:37:54.3356536Z   CXXFLAGS: -std=c++20
2025-10-10T16:37:54.3356707Z   NODE_ENV: test
2025-10-10T16:37:54.3356882Z   NPM_CONFIG_PRODUCTION: false
2025-10-10T16:37:54.3357082Z ##[endgroup]
2025-10-10T16:37:54.7065920Z [tests] Status: PASS
2025-10-10T16:37:54.7082697Z [tests] Report path: coverage/
2025-10-10T16:37:54.8494356Z ##[group]Run actions/upload-artifact@v4
2025-10-10T16:37:54.8494719Z with:
2025-10-10T16:37:54.8494968Z   name: coverage-summary
2025-10-10T16:37:54.8495254Z   path: coverage/coverage-summary.json
2025-10-10T16:37:54.8495493Z   retention-days: 14
2025-10-10T16:37:54.8495688Z   if-no-files-found: warn
2025-10-10T16:37:54.8495932Z   compression-level: 6
2025-10-10T16:37:54.8496194Z   overwrite: false
2025-10-10T16:37:54.8496413Z   include-hidden-files: false
2025-10-10T16:37:54.8496689Z env:
2025-10-10T16:37:54.8496915Z   NODE_VERSION_MATRIX: 18.x, 20.x, 22.x
2025-10-10T16:37:54.8497189Z   COVERAGE_THRESHOLD: 90
2025-10-10T16:37:54.8497431Z   SENTRY_DSN: 
2025-10-10T16:37:54.8497688Z   SENTRY_TRACES_SAMPLE_RATE: 0
2025-10-10T16:37:54.8497930Z   CL: /std:c++20 /EHsc
2025-10-10T16:37:54.8498198Z   CXXFLAGS: -std=c++20
2025-10-10T16:37:54.8498461Z   NODE_ENV: development
2025-10-10T16:37:54.8499006Z   NPM_CONFIG_PRODUCTION: false
2025-10-10T16:37:54.8499467Z ##[endgroup]
2025-10-10T16:37:55.3353241Z With the provided path, there will be 1 file uploaded
2025-10-10T16:37:55.3359833Z Artifact name is valid!
2025-10-10T16:37:55.3363073Z Root directory input is valid!
2025-10-10T16:37:55.4997446Z Beginning upload of artifact content to blob storage
2025-10-10T16:37:55.5897431Z Uploaded bytes 1493
2025-10-10T16:37:55.6130600Z Finished uploading artifact content to blob storage!
2025-10-10T16:37:55.6134791Z SHA256 digest of uploaded artifact zip is 8b8556768dd3a4eee10b1e86a9f091f670102591eeef7417f30a457353491ed6
2025-10-10T16:37:55.6137269Z Finalizing artifact upload
2025-10-10T16:37:55.7128492Z Artifact coverage-summary.zip successfully finalized. Artifact ID 4239366308
2025-10-10T16:37:55.7130254Z Artifact coverage-summary has been successfully uploaded! Final size is 1493 bytes. Artifact ID is 4239366308
2025-10-10T16:37:55.7144297Z Artifact download URL: https://github.com/skyoxu/gametp/actions/runs/18412530982/artifacts/4239366308
2025-10-10T16:37:55.7470558Z Post job cleanup.
2025-10-10T16:37:56.0381299Z (node:2320) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
2025-10-10T16:37:56.0382392Z (Use `node --trace-deprecation ...` to show where the warning was created)
2025-10-10T16:37:56.0386932Z Cache hit occurred on the primary key node-cache-Windows-x64-npm-fc17fb8d376abc8248800f4e980364e44d85f17a5d262a0278bfbe6dc7cc9aee, not saving cache.
2025-10-10T16:37:56.0708624Z Post job cleanup.
2025-10-10T16:37:56.3580945Z [command]"C:\Program Files\Git\bin\git.exe" version
2025-10-10T16:37:56.4058812Z git version 2.51.0.windows.2
2025-10-10T16:37:56.4132169Z Temporarily overriding HOME='D:\a\_temp\91caae38-048d-4204-ba68-b153be34c93e' before making global git config changes
2025-10-10T16:37:56.4132945Z Adding repository directory to the temporary git global config as a safe directory
2025-10-10T16:37:56.4143739Z [command]"C:\Program Files\Git\bin\git.exe" config --global --add safe.directory D:\a\gametp\gametp
2025-10-10T16:37:56.4468064Z [command]"C:\Program Files\Git\bin\git.exe" config --local --name-only --get-regexp core\.sshCommand
2025-10-10T16:37:56.4761820Z [command]"C:\Program Files\Git\bin\git.exe" submodule foreach --recursive "sh -c \"git config --local --name-only --get-regexp 'core\.sshCommand' && git config --local --unset-all 'core.sshCommand' || :\""
2025-10-10T16:37:57.1103156Z [command]"C:\Program Files\Git\bin\git.exe" config --local --name-only --get-regexp http\.https\:\/\/github\.com\/\.extraheader
2025-10-10T16:37:57.1363716Z http.https://github.com/.extraheader
2025-10-10T16:37:57.1414583Z [command]"C:\Program Files\Git\bin\git.exe" config --local --unset-all http.https://github.com/.extraheader
2025-10-10T16:37:57.1710292Z [command]"C:\Program Files\Git\bin\git.exe" submodule foreach --recursive "sh -c \"git config --local --name-only --get-regexp 'http\.https\:\/\/github\.com\/\.extraheader' && git config --local --unset-all 'http.https://github.com/.extraheader' || :\""
2025-10-10T16:37:57.6896001Z Cleaning up orphan processes
